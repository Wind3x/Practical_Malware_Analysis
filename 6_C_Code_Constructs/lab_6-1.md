# Answers to Questions

1. What is the major code construct found in the only subroutine called by main?

> The major code construct in sub\_401000 is an if statement which, depending on the outcome of a call to InternetGetConnectedState, passes either an offset for a success or failure message to sub\_40105F. 

2. What is the subroutine located at 0x40105F?

> Identifiable mainly by the parameters pushed prior to this function being called, we can hypothesize that this function accepts a format string and likely prints or writes it to a file. Calls to \_stbuf and \_ftbuf, C library functions for handling file stream buffers, support this hypothesis. Actually running the malware shows that it outputs "Success: Internet Connection" to the terminal. Combining these observations it is reasonable to guess that this subroutine is used for printing a format string to the terminal, possibly the C standard library printf function.

3. What is the purpose of this program?

> This program appears to check for internet connectivity and then prints the result of that check to the terminal, returning a 1 if the check revealed connectivity and a 0 if not. Connectivity checks are common to malware, especially samples that use command and control servers.
