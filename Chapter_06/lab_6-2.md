# Answers to Questions

1. What operation does the first subroutine called by main perform?

> The first subroutine called by main at 0x00401000 is similar to, if not the same as, the first subroutine called by main in the previous lab. It performs a call to InternetGetConnectedState and prints either a success or error message based on the outcome of the connectivity check, returning 1 for connectivity or 0 for no internet.

2. What is the subroutine located at 0x40117F?

> As in the previous lab, this subroutine appears to be printf and is used to print the strings from the calling subrouting to the terminal.

3. What does the second subroutine called by main do?

> If there is internet connectivity (call to sub\_401000 returns 1), main then calls sub\_401040. This function calls InternetOpenA with a user agent string of "Internet Explorer 7.5/pma", and then calls InternetOpenURL with a URL of "http://www.practicalmalwareanalysis.com/cc.htm". Following the success path, this subroutine reads a file from the URL, which, based on error message strings in the disassembly, appears to contain a command. Follwing the file being read into the Buffer, we see a series of comparisons, comparing each byte in the buffer to 0x3C, 0x21, 0x2D, and 0x2D which is ascii \<!-- , the format for an HTML comment. The last character accessed in the Buffer is moved into the AL register and control is passed back to main. Main uses this character in a format string that prints "Success: Parsed command is %c\n". Main then calls for a 60 second Sleep before it exits.

4. What type of code construct is used in this subroutine?

> This subroutine appears to use a series of nested if statements to check each character in the buffer.

5. Are there any network-based indicators for this program?

> After both static and dynamic analysis, it seems the main network indicators consist of the above mentioned user agent string and domain / URL.

6. What is the purpose of this malware?

> The malware checks for internet connectivity and downloads a command from the given URL, printing the command before sleeping and exiting.
