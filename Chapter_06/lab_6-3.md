# Answers to Questions

1. Compare the calls in main to Lab 6-2â€™s main method. What is the new function called from main?

> The new function is sub\_401130, called after the function from 6-2 that reads an HTML file from the internet and prints the command there.

2. What parameters does this new function take?

> This function accepts a char (the command parsed by the previous function), and a LPCSTR, which, according to MSDN is "A pointer to a constant null-terminated string of 8-bit Windows (ANSI) characters." This has been helpfully designated by IDA as lpExistingFileName which appears to be used in many file-operation API functions.

3. What major code construct does this function contain?

> This function contains a switch statement with 5 cases maintained using a jump table. To use the command character properly access the relevant index into the jump table, 61h (97 decimal or the character 'a') is subtracted from ecx. Therefore when the command passed in = 'a', the switch case 0 will be used. Since there are 5 cases (plus the default) we know that possible command characters include 'a' through 'e'. 

4. What can this function do?

> Depending on the switch, this function may create a directory C:\\Temp, copy a file (argv, the name of the program) to C:\\Temp\\cc.exe, delete a file (C:\Temp\cc.exe), open a run key in the registry and set a value of Malware and C:\\Temp\\cc.exe, or sleep for 100,000 milliseconds (100 seconds). 

5. Are there any host-based indicators for this malware?

> Obvious host-based indicators include the above directory path, file, and registry key. 

6. What is the purpose of this malware?

> This malware checks for internet connectivity before reading a page from a hardcoded URL which includes and HTML comment that is parsed for a character used as a command for a switch statement. Command options appear to mostly be used for establishing persistence (creating a directory, file, setting up a run key in the registry) and stealth (deleting the file, sleeping). After the command executes, the malware sleeps for a minute and exits. This malware could be classified as a backdoor.
