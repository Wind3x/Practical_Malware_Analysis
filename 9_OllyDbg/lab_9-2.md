# Answers to Questions that Took Roughly 2 Hours

1. What strings do you see statically in the binary?

> Hardly anything other than imported function names.

2. What happens when you run this binary?

> Seemingly nothing.

3. How can you get this sample to run its malicious payload?

> Rename the .exe to just 'ocl'.

4. What is happening at 0x00401133?

> ASCII characters being stored in local variables.

5. What arguments are being passed to subroutine 0x00401089?

> A pointer to a buffer at 0x12FD90 and the ASCII string set up by main.

6. What domain name does this malware use?

> www.practicalmalwareanalysis[.]com

7. What encoding routine is being used to obfuscate the domain name?

> XOR encoding.

8. What is the significance of the CreateProcessA call at 0x0040106E?

> Creates a process whose standard input/output is from/to the socket created for network communications by the malware, tied to cmd. This creates a reverse shell.

## Notes

Interesting strings/Imports

> * cmd
> * Lack of human-readable strings is interesting
> * GetACP/GetCPInfo/GetOEMCP
> * WriteFile
> * Sleep
> * CreateProcessA/TerminateProcess
> * WaitForSingleObject/CreateThread
> * WS2\_32
> * Registry functions

IDA 

> * Some sort of decode function at 0x401089
> * Sleeps for 30 seconds
> * Opening ASCII variables in main '1qaz2wsx3edc0ocl.exe0'

Olly

> * Checks to see if \<filename\> is ocl
> * String loaded in main at beginning is used to XOR decode buffer into domain
> * Beacons back to domain every 30 seconds
> * nc on port 9999 catches the malware sending OS version information
