# Answers Following a Short Hiatus

1. What happens when you run the malware executable?

> Pop-ups every minute. 

2. What process is being injected?

> explorer.exe.

3. How can you make the malware stop the pop-ups?

> Restart the explorer.exe process.

4. How does this malware operate?

> Uses EnumProcesses/EnumProcessModules to enumerate processes and checks each process's name against "explorer.exe". When found, the malwareinjects the Lab12-01.dll DLL into the process memory by creating a remote thread which loads the DLL and runs DllMain, causing the pop-up before sleeping for 60 seconds and repeating indefinitely.

## Notes

Static

> * GetLastActivePopup
> * GetActiveWindow
> * MessageBoxA
> * Sleep
> * Practical Malware Analysis %d
> * Press OK to reboot
> * CreateRemoteThread
> * WriteProcessMemory
> * explorer.exe

Dynamic

> * No network observed
> * No reg modifictions observed
> * Pops a message box every 60(?) seconds, increments number in top right each time

Advanced Static

> * Inject into every process whose ModuleBaseName is "explorer.exe"
> * Write Lab12-01.dll to process memory
> * VirtualAllocEx (0x104 bytes) > WriteProcessMemory (buffer = path to .dll) > GetModuleHandleA > GetProcAddress (LoadLibraryA) > CreateRemoteThread (loads Lab12-01.dll into explorer.exe)
> * Sleeps for one minute between CreateThread/MessageBoxA calls
