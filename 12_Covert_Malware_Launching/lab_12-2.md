# Answers to Life, the Universe, and Everything

1. What is the purpose of this program?

> Launches a keylogger.

2. How does the launcher program hide execution?

> Creates svchost.exe process and overwrites its process space with the keylogging binary.

3. Where is the malicious payload stored?

> In the .rsrc section of Lab12-02.exe.
 
4. How is the malicious payload protected?

> Single-byte XOR with a key of 0x41. 
 
5. How are strings protected?

> Single-byte XOR with a key of 0x41.

## Notes

Static

> * CreateFileA
> * SetThreadContext
> * ResumeThread
> * WriteProcessMemory
> * CreateProcessA
> * Sleep
> * \svchost.exe
> * UNICODE
> * LOCALIZATION
> * a lot of "A"s > potential single-byte XOR?

> * Extracting the .rsrc section and XORing with 0x41 provides a second PE file with 3 sections
> * Strings suggest keylogging (practicalmalwareanalysis.log, [BACKSPACE], [DEL], etc)
> * Imports SetWindowsHookEx, UnhookWindowsHookEx, WriteFile, GetWindowTextA, etc
> * Strings include "Process Monitor Filter"

Dynamic

> * No obvious output, network, or registry changes
> * Orphaned svchost.exe process appears w/ different strings in memory than on disk (appears to be PE from above)
> * Created file "practicalmalwareanalysis" in same directory (not shown in Process Monitor?)
> * File contains a list of windows opened, plus keys pressed

Advanced Static

> * CreateProcessA w/ CREATE\_SUSPENDED flag
> * NtUnmapViewOfSection on the process to remove from memory
> * WriteProcessMemory to write PE to process's memory space
> * LoadResource -> XOR decode w/ 0x41 key -> PE file being injected
