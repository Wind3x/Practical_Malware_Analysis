# Long Answers to Short Questions

1. What are this malware’s imports and strings? 

> Using Dependency Walker, the only visible import is the function ExitProcess from Kernel32.dll. This may indicate that the malware is packed or imports future code via runtime linking. Strings output contains other DLL names such as Ws2\_32, advapi32, ntdll, and user32, however, PEiD calls out the PE as being packed with PEncrypt 3.1.
>
> Other interesting strings present include some registry keys, an executable name, and plaintext strings:
>
> * SOFTWARE\Classes\http\shell\open\CommandV
> * SOFTWARE\Microsoft\Active Setup\Installed Components\
> * SOFTWARE\Microsoft\Windows\CurrentVersion\Run
> * SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
> 
> * vmx32to64.exe
>
> * www.practicalmalwareanalysis.com
> * VideoDriver
> * WinVMX32

Hypothesis: The program uses the Run key for persistence, has network functionality, and possibly masquerades as VideoDriver software.

2. What are the malware’s host-based indicators? 

> Process Monitor catches the process writing a file to the System32 folder using the executable name identified in the strings output and then proceeding to add the path to the executable to the Run key in the registry under 'VideoDriver'.
>
> Process Explorer allows us to see that the process uses the other interesting string (identified above) as a Mutex and does, in fact, load further DLLs after execution.

Hypothesis: The malware tries to hide a binary in the System32 folder for persistence and sets the registry entry to ensure the malicious executable is launched on startup. The mutex is likely used to ensure that only one copy of the malware is running on the system and the runtime-linked DLLs indicate network functionality.

3. Are there any useful network-based signatures for this malware? If so, what are they?

> ApateDNS catches the expected DNS lookup for the domain identified in the strings output. Using Wireshark we can
see an attempted connection to the domain over port 443 and that the transmitted data appears to be encrypted.

Hypothesis: The malware may be using the observed domain for encrypted command and control communications over port 443 to blend in with common traffic and subvert any firewall rules for outbound traffic.
