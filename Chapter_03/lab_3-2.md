# Long Answers to Short Questions

**1. How can you get this malware to install itself?**

> Using Dependency Walker to look at functions exported by the DLL, we can see that it exports two functions that seem likely to assist with installation: installA and Install. The presence of a ServiceMain function suggest that the program will need to be installed as a service in order to run which can be achieved by running ```rundll32.exe <dll_name>,<function>```.

**Hypothesis:** Looking at functions imported by the DLL, it may have the ability to create and modify services, registry entries, and imports network functionality from Ws2_32 and Wininet. The malware may utilize the registry for persistence and network communications for command and control. The malware seems slightly obfuscated, with strings output including some base64-encoded strings such as **Y29ubmVjdA==** (connect). Strings output further includes potential network indicators (domains, user agent strings, html resources) and host indicators (registry paths, file paths). One of the most interesting things turned up by running strings against the DLL is what seems to be the name and description of a program, potentially what the malware is masquerading as: _Depends INA+, Collects and stores network configuration and location information, and notifies applications when this information changes._

**2. How would you get this malware to run after installation?**

> Using Regshot to take snapshots of the registry before and after exeucting the malware and then comparing the snapshots shows that the registry tree for services (HKLM\SYSTEM\CurrentControlSet\Services) has a new key ending in **\IPRIP**. Furthermore, the ImagePath key has a new value of **svchost.exe -k netsvcs** which specifies that the service host process will be used to run the malware. From this information, we know to start the service using ```net start IPRIP``` and we can either use hover text (by hovering over each svchost.exe process until we find one that says netsvcs) or the Find tool in Process Explorer to locate the process ID (PID) and verify that the malware is running.

**3. How can you find the process under which this malware is running?**

> See (2) above.

**4. Which filters could you set in order to use procmon to glean information?**

> The filter I most commonly set in ProcMon is just filtering to the name of the process or in this case with multiple processes running named svchost.exe, the PID. 

**5. What are the malwareâ€™s host-based indicators?**

> Host-based inidcators found in strings output and via regshot include the above-mentioned services and registry entries.

**6. Are there any useful network-based signatures for this malware?**

> Network-based indicators include the domain found via strings output (and observed in an HTTP GET request for **/serve.html**) **practicalmalwareanalysis.com**. The user agent string included in this request is in the format of **<computer_name> Windows XP 6.11** and would also make a decent network signature.
