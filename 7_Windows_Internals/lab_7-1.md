# Short Answers to Questions

1. How does this program ensure that it continues running (achieves persistence) when the computer is restarted?

> MalService service created with the first function called by main, StartServiceCtrlDispatcherA with the function 0x00401040 as the ServiceMain function (lpServiceProc parameter) that will be executed when the MalService is started.

2. Why does this program use a mutex?

> The code includes a check for an existing mutex named HGL345, to make sure it is the only copy of the malware running. If the mutex exists, the code exits, if not it creates the mutex and continues running.

3. What is a good host-based signature to use for detecting this program?

> * The mutex HGL345
> * The service "MalService" and additions to the registry for Malservice

4. What is a good network-based signature for detecting this malware?

> * http://www.malwareanalysisbook[.]com
> * Internet Explorer 8.0

5. What is the purpose of this program?

> Creates a service for persistence, waits until midnight on January 1, 2100 then creates 20 threads to execute calls to the malwareanalysis site in an infinite loop.

6. When will this program finish executing?

> Never, as the loop for the network calls does not exit.

