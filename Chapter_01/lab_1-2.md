# Long Answers to Short Questions

1. Upload the Lab01-02.exe file to http://www.VirusTotal.com/. Does it match any existing antivirus definitions? 

> Using VirusTotal, the executable file is picked up by 39/65 Antivirus engines at the time of analysis. It is most commonly identified as a (Generic) Trojan. 

Hypothesis: likely Trojan

2. Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible. 

> While there are some human-readable strings present, the file does seem to be packed. PEview shows us the virtual size of each section is larger than the raw size. The sections are named UPX0, UPX1, and UPX2 which may be indicative of the common UPX packer being used to pack this executable. We can unpack the executable by downloading UPX and running

```upx -d Lab01-02.exe -o <file_name>```

```-d``` for "decompress" and ```-o``` for "output". (Running the above without the ```-o``` flag will cause a Permission error which can be difficult to diagnose properly).

Hypothesis: Being packed is further indication of this executable's probable maliciousness.

3. Do any imports hint at this programâ€™s functionality? If so, which imports are they and what do they tell you?

> Dependency Walkter shows that the packed file has some imports common to packed executables, such as _LoadLibraryA_ and _GetProcAddress_.

> The unpacked file has significantly more functions to look through, indicating functionality such as

> * Interaction with Windows services via _CreateServiceA_ (advapi32.dll)
> * Internet access via _InternetOpenA_ and _InternetOpenURLA_ (wininet.dll)
> * Other, more generic, functions from kernel32.dll and msvcrt.dll

Hypothesis: The program may create a service for persistence and may include command and control, exfiltration, or second-stage downloads over the internet, post-infection.

4. What host- or network-based indicators could be used to identify this malware on infected machines? 

Using FLOSS (FireEye Labs Obfuscated String Solver) on either the packed or unpacked files reveals a few interesting strings that support the hypothesis from #3 above:

> * http://malwareanalysisbook.com
> * Internet Explorer 8.0
> * MalService

Hypothesis: The program may create a service "MalService" for persistence and likely connects to the domain malwareanalysisbook.com (using IE 8 or with the user agent). The service name provides a host-based indicator of compromise (IOC) and the URL provides a network-based IOC that can be used to sweep for infected machines. 
